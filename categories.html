<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Day 04</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
</head>

<body>
    <div class="container mt-4">
        <div>
        <h3>Data from API</h3>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal">+Add Category</button>
        </div>
        <hr>
        <table class="table table-bordered">
            <thead id="tabHead">
                <tr>
                    <th>Id</th>
                    <th>Category</th>
                    <!-- <th>Category</th> -->
                    <!-- <th>Desc</th> -->
                    <th>Date</th>
                </tr>
            </thead>
            <tbody id="tabData">

            </tbody>
        </table>

        <form class="modal" id="myModal">
            <div class="modal-dialog">
              <div class="modal-content">
          
                <!-- Modal Header -->
                <div class="modal-header">
                  <h4 class="modal-title">Categories</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
          
                <!-- Modal body -->
                <div class="modal-body">
                  <p><b>Category Name</b></p>
                  <input type="text" class="form-control" id="inputPassword3" placeholder="Enter Category Name">
                </div>
          
                <!-- Modal footer -->
                <div class="modal-footer">
                  <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary">+ Add</button>
                </div>

          
              </div>
            </div>
          </form>

        <!-- <button id="nxtPage" type="button" currPage="1" class="btn btn-primary" >Next Page</button> -->
    </div>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"
        integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        crossorigin="anonymous"></script>


    <script>
        var tabHead = ''; var tabData = '';
        function loadData() {
            $.ajax({
                type: "GET",
                url: "https://sandbox.pranavdev.space/gadgets/api/list-all-categories",
                success: function (response) {
                    if (response.status == "success") {
                        var data = response.data;
                        var tabData = '';

                        for (var i = 0; i < data.length; i++) {
                            console.log(data[i]);
                            tabData += '<tr>';
                            tabData += '<td>' + data[i].id + '</td>';
                            tabData += '<td>' + data[i].name + '</td>';
                            tabData += '<td>' + data[i].created_at + '</td>';
                            tabData += '</tr>';
                        }
                        $('#tabData').html(tabData);
                    }else{
                        console.error(response.message)
                    }

                }
            });            
        }
        $(document).ready(function () {
            loadData();

            $(document).on('click', '#myModal .btn-primary', function () {
                var categoryName = $('#inputPassword3').val();
                // var pageNo=$(this).attr('currPage');
                // pageNo= parseInt(pageNo)+1;

                $.ajax({
                    type: "POST",
                    url: "https://sandbox.pranavdev.space/gadgets/api/add-category",
                    data: { name: categoryName },
                    success: function (response) {
                        if (response.status == "success") {
                            var newCategory = response.data;

                            var newRow = '<tr>';
                            newRow += '<td>' + newCategory.id + '</td>';
                            newRow += '<td>' + newCategory.name + '</td>';
                            newRow += '<td>' + newCategory.created_at + '</td>';
                            newRow += '</tr>';

                            $('#tabData').append(newRow);
                            $('#inputPassword3').val('');
                            $('#myModal').modal('hide');
                            loadData();
                        } else {
                            console.log(response.message);
                        }
                    }
                });
            });
        });
        // $(document).on('click', '#myModal .btn-primary', function () {
        //     loadData();
        //     var categoryName = $('#inputPassword3').val();
        //     $.ajax({
        //         type: "POST",
        //         url: "https://sandbox.pranavdev.space/gadgets/api/add-category",
        //         data: { name: categoryName },
        //         success: function (response) {
        //             if (response.status == "success") {
        //                 var newCategory = response.data;

        //                 var newRow = '<tr>';
        //                 newRow += '<td>' + newCategory.id + '</td>';
        //                 newRow += '<td>' + newCategory.name + '</td>';
        //                 newRow += '<td>' + newCategory.created_at + '</td>';
        //                 newRow += '</tr>';

        //                 $('#tabData').append(newRow);
        //                 $('#inputPassword3').val('');
        //                 $('#myModal').modal('hide');
        //             } else {
        //                 console.log("Error adding category.");
        //             }
        //         }
        //     });
        // });

        // $(document).ready(function () {
        //     loadData();
        //     $(document).on('click', '#nxtPage',function () {
        //         tabData = '';
        //         var pageNo=$(this).attr('currPage');
        //         pageNo= parseInt(pageNo)+1;
        //         $.ajax({
        //             type: "POST",
        //             url: "https://sandbox.pranavdev.space/gadgets/api/add-category",
        //             data:{page:pageNo},
        //             success: function (response) {
        //                 $('#nxtPage').attr('currPage',pageNo);
        //                console.log(response);

        //                 if (response.status == "success") {
        //                     var data = response.data;

        //                     for (var i = 0; i < data.length; i++) {
        //                         tabData += '<tr>';
        //                         tabData += '<td>' + data[i].name + '</td>';
        //                         tabData += '</tr>';
        //                     }
        //                     $('#tabData').html(tabData);
        //                     var pagination=response.pagination;
        //                     console.log(pagination.current_page);
        //                     console.log(pagination.total_pages);

        //                    if(pagination.total_pages==pageNo){
                           
        //                      $('#nxtPage').attr('disabled', true);
                            
        //                    }
        //                 }
        //                 else{
        //                     $('#tabData').html('No Product Found');
        //                     //$('#nxtPage').hide();

        //                 }

        //             }
        //         });
        //     });
        // });
    </script>
</body>

</html>

